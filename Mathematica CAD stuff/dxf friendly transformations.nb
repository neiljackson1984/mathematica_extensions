(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[     42746,       1109]
NotebookOptionsPosition[     40868,       1042]
NotebookOutlinePosition[     41249,       1058]
CellTagsIndexPosition[     41206,       1055]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"In", " ", "this", " ", "file"}], ",", " ", 
   RowBox[{"I", " ", "define", "  ", "functions", " ", 
    RowBox[{"rotate", "[", "]"}], " ", "and", " ", 
    RowBox[{
     RowBox[{"translate", "[", "]"}], ".", "  ", "These"}], " ", "functions", 
    " ", "replace", " ", "all", " ", 
    RowBox[{"Circle", "[", "...", "]"}], " ", "constructs"}], ",", " ", 
   RowBox[{
    RowBox[{"Point", "[", "...", "]"}], " ", "constructs"}], ",", " ", 
   RowBox[{"and", " ", 
    RowBox[{"Line", "[", "...", "]"}], " ", "constructs"}], ",", " ", 
   RowBox[{"with", " ", "the", " ", 
    RowBox[{"rotated", "/", "translated"}], " ", "versions", " ", "of", " ", 
    "these", " ", 
    RowBox[{"constructs", ".", "  ", "This"}], " ", "replacement", " ", "is", 
    " ", "made", " ", "at", " ", "every", " ", "level"}], ",", " ", 
   RowBox[{"wherever", " ", "these", " ", "constructs", " ", "occur"}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.484060017421875*^9, 3.484060157859375*^9}, {
  3.484065819015625*^9, 3.484065829203125*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"rotate", "[", 
      RowBox[{"object_", ",", "rotationangle_", ",", 
       RowBox[{"anchorpoint_:", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}]}]}], "]"}], " ", ":=", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Replace", "[", 
        RowBox[{"object", ",", "#", ",", "Infinity"}], "]"}], "&"}], " ", "@",
       "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"this", " ", "is", " ", "how", " ", "we", " ", "rotate", " ", 
         RowBox[{"Circle", "[", "...", "]"}], " ", "constructs"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"circle_", "?", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Head", "[", "#", "]"}], " ", "\[Equal]", " ", 
              "Circle"}], " ", "&"}], ")"}]}], " ", "\[RuleDelayed]", " ", 
          RowBox[{"Circle", " ", "@@", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"rotatepoint", "[", 
               RowBox[{
                RowBox[{
                "circle", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], ",", "rotationangle"}], "]"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{
              "circle", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}]}], "\[IndentingNewLine]", "}"}], 
            "\[IndentingNewLine]", "~", "Join", "~", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "circle", "]"}], " ", "\[Equal]", " ", 
               "3"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"rotationangle", "*", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "1"}], "}"}]}], " ", "+", " ", 
                RowBox[{
                "circle", "\[LeftDoubleBracket]", "3", 
                 "\[RightDoubleBracket]"}]}], "}"}], ",", 
              RowBox[{"{", "}"}]}], "]"}]}]}]}], "\[IndentingNewLine]", ")"}],
         ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"this", " ", "is", " ", "how", " ", "we", " ", "rotate", " ", 
          RowBox[{"Point", "[", "...", "]"}], " ", "constructs"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"point_", "?", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Head", "[", "#", "]"}], " ", "\[Equal]", " ", 
                "Point"}], " ", "&"}], ")"}]}], " ", "\[RuleDelayed]", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"Replace", "[", 
             RowBox[{"point", ",", "#", ",", "Infinity"}], "]"}]}], "&"}], 
          " ", "@", "\[IndentingNewLine]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"xy_", "?", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"MatchQ", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"NumericQ", "[", "#", "]"}], "&"}], ")"}]}], ",", 
                   " ", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"NumericQ", "[", "#", "]"}], "&"}], ")"}]}]}], 
                  "}"}]}], "]"}], "&"}], ")"}]}], " ", "\[RuleDelayed]", " ", 
            RowBox[{"rotatepoint", "[", 
             RowBox[{"xy", ",", "rotationangle"}], "]"}]}], 
           "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", ")"}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"this", " ", "is", " ", "how", " ", "we", " ", "rotate", " ", 
          RowBox[{"Line", "[", "...", "]"}], " ", "constructs"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"line_", "?", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Head", "[", "#", "]"}], " ", "\[Equal]", " ", 
                "Line"}], " ", "&"}], ")"}]}], " ", "\[RuleDelayed]", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"Replace", "[", 
             RowBox[{"line", ",", "#", ",", "Infinity"}], "]"}]}], "&"}], " ",
           "@", "\[IndentingNewLine]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"xy_", "?", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"MatchQ", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"NumericQ", "[", "#", "]"}], "&"}], ")"}]}], ",", 
                   " ", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"NumericQ", "[", "#", "]"}], "&"}], ")"}]}]}], 
                  "}"}]}], "]"}], "&"}], ")"}]}], " ", "\[RuleDelayed]", " ", 
            RowBox[{"rotatepoint", "[", 
             RowBox[{"xy", ",", "rotationangle"}], "]"}]}], 
           "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", ")"}]}], 
       "\[IndentingNewLine]", "}"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"translate", "[", 
      RowBox[{"object_", ",", " ", "translationvector_"}], "]"}], " ", ":=", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"#", ",", "1"}], "]"}], "&"}], " ", "@@", " ", 
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"{", "object", "}"}], ",", "#", ",", "Infinity"}], "]"}]}], 
       "&"}], " ", "@", " ", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"the", " ", "extra", " ", "enclosing", " ", 
         RowBox[{"{", "}"}], " ", "and", " ", "flattening", " ", "is", " ", 
         "required", " ", "because"}], ",", " ", 
        RowBox[{"for", " ", "some", " ", "reason"}], ",", " ", 
        RowBox[{
        "when", " ", "Replace", " ", "is", " ", "called", " ", "with", " ", 
         "a", " ", "levelspec", " ", 
         RowBox[{"(", 
          RowBox[{"third", " ", "argument"}], ")"}]}], ",", " ", 
        RowBox[{
        "it", " ", "does", " ", "not", " ", "do", " ", "any", " ", 
         "replacement", " ", "at", " ", "the", " ", "zeroeth", " ", 
         RowBox[{"level", ".", "  ", "Without"}], " ", "this"}], ",", " ", 
        RowBox[{"translate", "[", 
         RowBox[{
          RowBox[{"Point", "[", 
           RowBox[{"1", ",", "1"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}]}], "]"}], ",", " ", 
        RowBox[{"for", " ", "instance", " ", "would", " ", "not", " ", 
         RowBox[{"work", ".", "  ", "You"}], " ", "would", " ", "have", " ", 
         "to", " ", "enclose", " ", "the", " ", "point", " ", "in", " ", 
         RowBox[{"braces", ".", "  ", "But"}]}], ",", " ", 
        RowBox[{"with", " ", "this", " ", "fix"}], ",", " ", 
        RowBox[{"translate", " ", "can", " ", "accept", " ", "bare", " ", 
         RowBox[{"Point", "[", "]"}]}], ",", " ", 
        RowBox[{"Circle", "[", "]"}], ",", 
        RowBox[{
        "...", " ", "constructs", " ", "and", " ", "deal", " ", "with", " ", 
         "them", " ", 
         RowBox[{"sensibly", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "this", " ", "is", " ", "how", " ", "we", " ", "translate", " ", 
         RowBox[{"Circle", "[", "...", "]"}], " ", "constructs"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"circle_", "?", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Head", "[", "#", "]"}], " ", "\[Equal]", " ", 
              "Circle"}], " ", "&"}], ")"}]}], " ", "\[RuleDelayed]", " ", 
          RowBox[{"Circle", " ", "@@", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
              "circle", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}], " ", "+", " ", 
              "translationvector"}], "}"}], " ", "~", "Join", "~", " ", 
            RowBox[{"Rest", "[", 
             RowBox[{"Level", "[", 
              RowBox[{"circle", ",", "1"}], "]"}], "]"}]}]}]}], 
         "\[IndentingNewLine]", ")"}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "this", " ", "is", " ", "how", " ", "we", " ", "translate", " ", 
          RowBox[{"Point", "[", "...", "]"}], " ", "constructs"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"point_", "?", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Head", "[", "#", "]"}], " ", "\[Equal]", " ", 
                "Point"}], " ", "&"}], ")"}]}], " ", "\[RuleDelayed]", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"Replace", "[", 
             RowBox[{"point", ",", "#", ",", "Infinity"}], "]"}]}], "&"}], 
          " ", "@", "\[IndentingNewLine]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"xy_", "?", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"MatchQ", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"NumericQ", "[", "#", "]"}], "&"}], ")"}]}], ",", 
                   " ", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"NumericQ", "[", "#", "]"}], "&"}], ")"}]}]}], 
                  "}"}]}], "]"}], "&"}], ")"}]}], " ", "\[RuleDelayed]", " ", 
            RowBox[{"xy", " ", "+", " ", "translationvector"}]}], 
           "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", ")"}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "this", " ", "is", " ", "how", " ", "we", " ", "translate", " ", 
          RowBox[{"Line", "[", "...", "]"}], " ", "constructs"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"line_", "?", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Head", "[", "#", "]"}], " ", "\[Equal]", " ", 
                "Line"}], " ", "&"}], ")"}]}], " ", "\[RuleDelayed]", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"Replace", "[", 
             RowBox[{"line", ",", "#", ",", "Infinity"}], "]"}]}], "&"}], " ",
           "@", "\[IndentingNewLine]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"xy_", "?", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"MatchQ", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"NumericQ", "[", "#", "]"}], "&"}], ")"}]}], ",", 
                   " ", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"NumericQ", "[", "#", "]"}], "&"}], ")"}]}]}], 
                  "}"}]}], "]"}], "&"}], ")"}]}], " ", "\[RuleDelayed]", " ", 
            RowBox[{"xy", " ", "+", " ", "translationvector"}]}], 
           "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", ")"}]}], 
       "\[IndentingNewLine]", "}"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"FOR", " ", "THE", " ", "BELOW", " ", "TWO", " ", "FUNCTIONS"}], 
     ",", " ", 
     RowBox[{
     "SEE", " ", "IF", " ", "IT", " ", "IS", " ", "POSSIBLE", " ", "TO", " ", 
      "DEFINE", " ", "THEM", " ", "IN", " ", "AN", " ", "OVERLOADED", " ", 
      "FASHION", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"ONE", " ", "VERSION", " ", "FOR", " ", "VECTOR"}], ",", " ", 
        RowBox[{"ONE", " ", "FOR", " ", "ANGLE"}]}], ")"}]}], ",", " ", 
     RowBox[{
     "RATHER", " ", "THAN", " ", "EVALUATING", " ", "THE", " ", "TYPE", " ", 
      "OF", " ", "THE", " ", "ARGUMENT", " ", "EXPLICITLY", " ", "WITHIN", 
      " ", "THE", " ", "FUNCTION"}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"reflect", "[", 
      RowBox[{"object_", ",", " ", "vectororangle_", ",", 
       RowBox[{"anchorpoint_:", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}]}]}], "]"}], " ", ":=", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Replace", "[", 
        RowBox[{"object", ",", "#", ",", "Infinity"}], "]"}], "&"}], " ", "@",
       "\[IndentingNewLine]", 
      RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"this", " ", "is", " ", "how", " ", "we", " ", "reflect", " ", 
         RowBox[{"Circle", "[", "...", "]"}], " ", "constructs"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"circle_", "?", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Head", "[", "#", "]"}], " ", "\[Equal]", " ", 
              "Circle"}], " ", "&"}], ")"}]}], " ", "\[RuleDelayed]", " ", 
          RowBox[{"Circle", " ", "@@", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"reflectpoint", "[", 
               RowBox[{
                RowBox[{
                "circle", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], ",", "vectororangle", ",", 
                "anchorpoint"}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{
              "circle", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}]}], "\[IndentingNewLine]", "}"}], 
            "\[IndentingNewLine]", "~", "Join", "~", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", "circle", "]"}], " ", "\[Equal]", " ", 
               "3"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{"reflectanglerange", "[", " ", 
                RowBox[{
                 RowBox[{
                 "circle", "\[LeftDoubleBracket]", "3", 
                  "\[RightDoubleBracket]"}], " ", ",", " ", "vectororangle"}],
                 "]"}], "}"}], ",", 
              RowBox[{"{", "}"}]}], "]"}]}]}]}], "\[IndentingNewLine]", ")"}],
         ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "this", " ", "is", " ", "how", " ", "we", " ", "reflect", " ", 
          RowBox[{"Point", "[", "...", "]"}], " ", "constructs"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"point_", "?", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Head", "[", "#", "]"}], " ", "\[Equal]", " ", 
                "Point"}], " ", "&"}], ")"}]}], " ", "\[RuleDelayed]", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"Replace", "[", 
             RowBox[{"point", ",", "#", ",", "Infinity"}], "]"}]}], "&"}], 
          " ", "@", "\[IndentingNewLine]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"xy_", "?", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"MatchQ", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"NumericQ", "[", "#", "]"}], "&"}], ")"}]}], ",", 
                   " ", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"NumericQ", "[", "#", "]"}], "&"}], ")"}]}]}], 
                  "}"}]}], "]"}], "&"}], ")"}]}], " ", "\[RuleDelayed]", " ", 
            RowBox[{"reflectpoint", "[", 
             RowBox[{
             "xy", " ", ",", " ", "vectororangle", ",", " ", "anchorpoint"}], 
             "]"}]}], "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", ")"}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "this", " ", "is", " ", "how", " ", "we", " ", "reflect", " ", 
          RowBox[{"Line", "[", "...", "]"}], " ", "constructs"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"line_", "?", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Head", "[", "#", "]"}], " ", "\[Equal]", " ", 
                "Line"}], " ", "&"}], ")"}]}], " ", "\[RuleDelayed]", " ", 
            "\[IndentingNewLine]", 
            RowBox[{"Replace", "[", 
             RowBox[{"line", ",", "#", ",", "Infinity"}], "]"}]}], "&"}], " ",
           "@", "\[IndentingNewLine]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"xy_", "?", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"MatchQ", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"NumericQ", "[", "#", "]"}], "&"}], ")"}]}], ",", 
                   " ", 
                   RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"NumericQ", "[", "#", "]"}], "&"}], ")"}]}]}], 
                  "}"}]}], "]"}], "&"}], ")"}]}], " ", "\[RuleDelayed]", " ", 
            RowBox[{"reflectpoint", "[", 
             RowBox[{
             "xy", " ", ",", " ", "vectororangle", ",", " ", "anchorpoint"}], 
             "]"}]}], "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", 
         ")"}]}], "\[IndentingNewLine]", "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "this", " ", "will", " ", "reflect", " ", "the", " ", "point", " ", 
     "about", " ", "the", " ", "line", " ", "defined", " ", "by", " ", "the", 
     " ", "anchorpoint", " ", "and", " ", "normalizable", " ", "vector", " ", 
     RowBox[{"(", 
      RowBox[{
      "or", " ", "the", " ", "anchorpoint", " ", "and", " ", "the", " ", 
       "angle", " ", "if", " ", "the", " ", "third", " ", "asrgument", " ", 
       "is", " ", "a", " ", "number", " ", "instead", " ", "of", " ", "a", 
       " ", 
       RowBox[{"list", "."}]}], " "}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"reflectpoint", "[", 
      RowBox[{"point_", ",", "vectororangle_", ",", 
       RowBox[{"anchorpoint_:", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}]}]}], "]"}], " ", ":=", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"Block", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "r", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"MatchQ", "[", 
           RowBox[{"vectororangle", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"_", "?", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"NumericQ", "[", "#", "]"}], "&"}], ")"}]}], ",", 
              " ", 
              RowBox[{"_", "?", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"NumericQ", "[", "#", "]"}], "&"}], ")"}]}]}], 
             "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"r", " ", "=", " ", 
           RowBox[{"Normalize", "[", "vectororangle", "]"}]}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"NumericQ", "[", "vectororangle", "]"}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"r", " ", "=", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Cos", "[", "vectororangle", "]"}], ",", 
             RowBox[{"Sin", "[", "vectororangle", "]"}]}], "}"}]}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"anchorpoint", " ", "+", " ", 
          RowBox[{"2", "*", 
           RowBox[{"(", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"point", "-", "anchorpoint"}], ")"}], ".", "r"}], ")"}],
            "  ", "*", "r"}], " ", "-", 
          RowBox[{"(", 
           RowBox[{"point", "-", "anchorpoint"}], ")"}]}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "this", " ", "will", " ", "reflect", " ", "the", " ", "anglerange", " ", 
     RowBox[{"{", 
      RowBox[{"angle1", ",", " ", "angle2"}], "}"}], " ", "about", " ", "the",
      " ", "line", " ", "defined", " ", "by", " ", "the", " ", "anchorpoint", 
     " ", "and", " ", 
     RowBox[{"angle", ".", "  ", "this"}], " ", "will", " ", "be", " ", 
     "used", " ", "when", " ", "reflecting", " ", 
     RowBox[{"arcs", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"reflectanglerange", "[", 
      RowBox[{"anglerange_", ",", "vectororangle_"}], "]"}], " ", ":=", "  ", 
     "\[IndentingNewLine]", 
     RowBox[{"Block", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "\[Theta]", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"MatchQ", "[", 
              RowBox[{"#", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"_", "?", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"NumericQ", "[", "#", "]"}], "&"}], ")"}]}], ",", 
                 " ", 
                 RowBox[{"_", "?", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"NumericQ", "[", "#", "]"}], "&"}], ")"}]}]}], 
                "}"}]}], "]"}], "&"}], ")"}], " ", "@", " ", 
           "vectororangle"}], ",", "\[IndentingNewLine]", 
          RowBox[{"\[Theta]", " ", "=", " ", 
           RowBox[{"angle", "[", "vectororangle", "]"}]}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"NumericQ", " ", "@", " ", "vectororangle"}], ",", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"\[Theta]", " ", "=", " ", "vectororangle"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"Reverse", "[", 
          RowBox[{
           RowBox[{"2", "*", "\[Theta]"}], "-", "anglerange"}], "]"}], "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJwt0U0ow2EcwPEn8jYv2+SGw3BwGSWFkqzkYLWYzVxWXiKJlPcm298OEuIy
EpKi3MhSSFqslOTE4iAvB+GkDBN52/Pd4d+n7+/3PJfnr2vqMrdECSHy/7+w
QmiM1W9PBqGoLVJx2UCbWmlbB9r7MNXBvniYnnXTR3P0zSLm+VE8s/9EkfaO
j7E10spM7EDFl4XabCzQs/dEPC9nfhfRZcRxM07Uce7WhqFO7BzCkqBZnrt/
xesvqZhPrpV60zEnA2MNUsVpoxMGsN2JS5N4OI2FM5jr457+hDac0Sk3uBpk
Hghh3Adzyze98ov2GAvvo5IqXg1u65k7CrG/BEvLcCziWyvnlTbaNIgqB164
0O3G1DWM3kTPLve1e/TDAW0/onfirdLRRCv/WY26DOanOkwqwpdu9r099M8Y
Nk9hxRX7ERSa2dVQuI0Rn9alonaDbtyid3dweZ95lR/rj5kvBML+AftuVYA=

  "]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"vector", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"15", ",", "35"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"anchorpoint", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "3"}], ",", 
     RowBox[{"-", "10"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"point", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Graphics", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Line", "[", 
         RowBox[{"{", 
          RowBox[{"anchorpoint", ",", 
           RowBox[{"anchorpoint", "+", "vector"}]}], "}"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Point", "[", "point", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Point", "[", "\[IndentingNewLine]", 
         RowBox[{"reflectpoint", "[", "\[IndentingNewLine]", 
          RowBox[{
          "point", ",", "\[IndentingNewLine]", "anchorpoint", ",", 
           "\[IndentingNewLine]", "vector"}], "\[IndentingNewLine]", "]"}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Circle", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "10"}], "}"}], ",", "2", ",", 
          RowBox[{"{", " ", 
           RowBox[{
            RowBox[{"x", " ", "Degree"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"x", " ", "-", "10", " ", "+", " ", "360"}], " ", ")"}],
              "Degree"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Circle", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"reflectpoint", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "10"}], "}"}], ",", "anchorpoint", ",", 
            "vector"}], "]"}], ",", "\[IndentingNewLine]", "2", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"reflectanglerange", "[", 
           RowBox[{
            RowBox[{"{", " ", 
             RowBox[{
              RowBox[{"x", " ", "Degree"}], ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"x", " ", "-", "10", " ", "+", " ", "360"}], " ", 
                ")"}], "Degree"}]}], "}"}], ",", "vector"}], "]"}]}], 
         "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Axes", " ", "\[Rule]", " ", "True"}]}], "\[IndentingNewLine]", 
     "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"-", "400"}], ",", "400", ",", "10"}], "}"}]}], 
   "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.484064455625*^9, 3.484064603828125*^9}, {
   3.48406464184375*^9, 3.4840646744375*^9}, {3.484065892625*^9, 
   3.484065899890625*^9}, {3.484066463015625*^9, 3.48406646559375*^9}, {
   3.484066637453125*^9, 3.484066640578125*^9}, {3.48406669815625*^9, 
   3.4840667086875*^9}, {3.484067325*^9, 3.484067325578125*^9}, {
   3.48406739528125*^9, 3.48406744675*^9}, {3.48406748015625*^9, 
   3.48406772625*^9}, 3.484067757984375*^9, 3.48406787503125*^9}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`x$$ = 50, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`x$$], -400, 400, 10}}, Typeset`size$$ = {
    147., {214., 218.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`x$8425$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`x$$ = -400}, 
      "ControllerVariables" :> {
        Hold[$CellContext`x$$, $CellContext`x$8425$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> Graphics[{
         Line[{$CellContext`anchorpoint, $CellContext`anchorpoint + \
$CellContext`vector}], 
         Point[$CellContext`point], 
         Point[
          $CellContext`reflectpoint[$CellContext`point, \
$CellContext`anchorpoint, $CellContext`vector]], 
         Circle[{1, 10}, 
          2, {$CellContext`x$$ Degree, ($CellContext`x$$ - 10 + 360) Degree}], 
         Circle[
          $CellContext`reflectpoint[{1, 
           10}, $CellContext`anchorpoint, $CellContext`vector], 2, 
          $CellContext`reflectanglerange[{$CellContext`x$$ 
            Degree, ($CellContext`x$$ - 10 + 360) 
            Degree}, $CellContext`vector]]}, Axes -> True], 
      "Specifications" :> {{$CellContext`x$$, -400, 400, 10}}, 
      "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{256., {258., 263.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.48406590078125*^9, 3.484066177375*^9, 3.484066299828125*^9, 
   3.484066640875*^9, {3.484067319796875*^9, 3.48406732665625*^9}, {
   3.4840674583125*^9, 3.48406753896875*^9}, 3.4840675791875*^9, 
   3.484067661859375*^9, 3.484067727171875*^9, 3.48406780034375*^9, 
   3.48406783353125*^9, 3.48406787759375*^9, 3.484067935734375*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["3", 
    SqrtBox["58"]], ",", 
   FractionBox["7", 
    SqrtBox["58"]]}], "}"}]], "Print",
 CellChangeTimes->{3.48406876890625*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["3", 
    SqrtBox["58"]], ",", 
   FractionBox["7", 
    SqrtBox["58"]]}], "}"}]], "Print",
 CellChangeTimes->{3.4840687689375*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox["3", 
     SqrtBox["109"]]}], ",", 
   RowBox[{"-", 
    FractionBox["10", 
     SqrtBox["109"]]}]}], "}"}]], "Print",
 CellChangeTimes->{3.484068948875*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox["3", 
     SqrtBox["109"]]}], ",", 
   RowBox[{"-", 
    FractionBox["10", 
     SqrtBox["109"]]}]}], "}"}]], "Print",
 CellChangeTimes->{3.4840689489375*^9}]
}, Open  ]]
}, Open  ]],

Cell[BoxData["|"], "Input",
 CellChangeTimes->{3.484067319640625*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NumericQ", "[", 
  RowBox[{"{", 
   RowBox[{"45", ",", "67"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.48406640465625*^9, 3.484066439015625*^9}, {
  3.484066525671875*^9, 3.484066575875*^9}, {3.48406666746875*^9, 
  3.48406668128125*^9}}],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{{3.4840664009375*^9, 3.4840664330625*^9}, {
  3.484066533515625*^9, 3.484066576453125*^9}, {3.48406664459375*^9, 
  3.48406668196875*^9}}]
}, Open  ]],

Cell[BoxData["anglevector"], "Input",
 CellChangeTimes->{{3.484066646625*^9, 3.48406664790625*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"angle", "[", "vector", "]"}]], "Input",
 CellChangeTimes->{{3.4840666506875*^9, 3.48406665203125*^9}}],

Cell[BoxData[
 RowBox[{"ArcCos", "[", 
  FractionBox["3", 
   SqrtBox["58"]], "]"}]], "Output",
 CellChangeTimes->{3.48406665234375*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reflectpoint", "[", "\[IndentingNewLine]", 
  RowBox[{
  "point", ",", "\[IndentingNewLine]", "anchorpoint", ",", 
   "\[IndentingNewLine]", "vector"}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.484066860765625*^9, 3.48406686140625*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["85", "29"], ",", 
   FractionBox["34", "29"]}], "}"}]], "Output",
 CellChangeTimes->{
  3.484066714078125*^9, {3.484066845515625*^9, 3.484066875515625*^9}, 
   3.484066908515625*^9, 3.48406708609375*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatchQ", "[", 
  RowBox[{"vector", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"NumericQ", "[", "#", "]"}], "&"}], ")"}]}], ",", " ", 
     RowBox[{"_", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"NumericQ", "[", "#", "]"}], "&"}], ")"}]}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.484066911390625*^9, 3.4840669468125*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.484066912265625*^9, 3.4840669479375*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reflectpoint", "[", "\[IndentingNewLine]", 
  RowBox[{
  "point", ",", "\[IndentingNewLine]", "anchorpoint", ",", 
   "\[IndentingNewLine]", " ", 
   RowBox[{"{", 
    RowBox[{"15", ",", "35"}], "}"}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{3.48406710021875*^9}],

Cell[BoxData["\<\"argument to reflectpoint was a vector\"\>"], "Print",
 CellChangeTimes->{3.484067296546875*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["85", "29"], ",", 
   FractionBox["34", "29"]}], "}"}]], "Output",
 CellChangeTimes->{{3.484067092390625*^9, 3.48406710078125*^9}, 
   3.48406715153125*^9, {3.484067215125*^9, 3.484067219015625*^9}, {
   3.484067267859375*^9, 3.484067296546875*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Definition", "[", "reflectpoint", "]"}]], "Input",
 CellChangeTimes->{{3.48406722790625*^9, 3.484067237546875*^9}}],

Cell[BoxData[
 InterpretationBox[GridBox[{
    {GridBox[{
       {
        RowBox[{
         RowBox[{"reflectpoint", "[", 
          RowBox[{"point_", ",", "anchorpoint_", ",", "vectororangle_"}], 
          "]"}], ":=", 
         RowBox[{"Block", "[", 
          RowBox[{
           RowBox[{"{", "r", "}"}], ",", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"MatchQ", "[", 
               RowBox[{"vectororangle", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"NumericQ", "[", "#1", "]"}], "&"}], ")"}]}], ",", 
                  RowBox[{"_", "?", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"NumericQ", "[", "#1", "]"}], "&"}], ")"}]}]}], 
                 "}"}]}], "]"}], ",", 
              RowBox[{
               RowBox[{"r", "=", 
                RowBox[{"Normalize", "[", "vector", "]"}]}], ";", 
               RowBox[{
               "Print", "[", "\<\"argument to reflectpoint was a vector\"\>", 
                "]"}]}]}], "]"}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"NumericQ", "[", "vectororangle", "]"}], ",", 
              RowBox[{
               RowBox[{"r", "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Cos", "[", "vectororangle", "]"}], ",", 
                  RowBox[{"Sin", "[", "vectororangle", "]"}]}], "}"}]}], ";", 
               RowBox[{
               "Print", "[", "\<\"argument to reflectpoint was a scalar\"\>", 
                "]"}]}]}], "]"}], ";", 
            RowBox[{"Return", "[", 
             RowBox[{"anchorpoint", "+", 
              RowBox[{"2", " ", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"point", "-", "anchorpoint"}], ")"}], ".", "r"}], 
               " ", "r"}], "-", 
              RowBox[{"(", 
               RowBox[{"point", "-", "anchorpoint"}], ")"}]}], "]"}], ";"}]}],
           "]"}]}]}
      },
      BaselinePosition->{Baseline, {1, 1}},
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{"Columns" -> {{
           Scaled[0.999]}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}}]}
   },
   BaselinePosition->{Baseline, {1, 1}},
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}}],
  Definition[$CellContext`reflectpoint],
  Editable->False]], "Output",
 CellChangeTimes->{3.48406723775*^9, 3.484067791796875*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Clear", "[", "reflectpoint", "]"}]], "Input",
 CellChangeTimes->{{3.484067253796875*^9, 3.48406725996875*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "reflectpoint", "]"}]], "Input",
 CellChangeTimes->{{3.48406807475*^9, 3.484068078078125*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"angle", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", "1"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.484068891875*^9, 3.48406889596875*^9}}],

Cell[BoxData[
 FractionBox["\[Pi]", "2"]], "Output",
 CellChangeTimes->{3.4840688963125*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"layernum", " ", "=", " ", "5"}]], "Input",
 CellChangeTimes->{{3.484069606984375*^9, 3.48406960975*^9}}],

Cell[BoxData["5"], "Output",
 CellChangeTimes->{3.48406961146875*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"layernum", " ", "+=", " ", "3"}]], "Input",
 CellChangeTimes->{{3.48406961253125*^9, 3.48406961521875*^9}}],

Cell[BoxData["8"], "Output",
 CellChangeTimes->{3.484069615625*^9}]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{1592, 1038},
WindowMargins->{{73, Automatic}, {Automatic, 452}},
FrontEndVersion->"7.0 for Microsoft Windows (32-bit) (November 10, 2008)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 1078, 22, 72, "Input"],
Cell[1626, 44, 25631, 597, 3032, "Input",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[27282, 645, 3353, 79, 592, "Input"],
Cell[30638, 726, 2461, 50, 538, "Output"],
Cell[CellGroupData[{
Cell[33124, 780, 187, 7, 43, "Print"],
Cell[33314, 789, 186, 7, 43, "Print"],
Cell[33503, 798, 230, 9, 43, "Print"],
Cell[33736, 809, 231, 9, 43, "Print"]
}, Open  ]]
}, Open  ]],
Cell[33994, 822, 69, 1, 31, "Input"],
Cell[CellGroupData[{
Cell[34088, 827, 268, 6, 31, "Input"],
Cell[34359, 835, 190, 3, 30, "Output"]
}, Open  ]],
Cell[34564, 841, 99, 1, 31, "Input"],
Cell[CellGroupData[{
Cell[34688, 846, 126, 2, 31, "Input"],
Cell[34817, 850, 136, 4, 50, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34990, 859, 281, 5, 112, "Input"],
Cell[35274, 866, 259, 7, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35570, 878, 442, 14, 31, "Input"],
Cell[36015, 894, 93, 1, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36145, 900, 308, 7, 112, "Input"],
Cell[36456, 909, 113, 1, 23, "Print"],
Cell[36572, 912, 304, 7, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36913, 924, 139, 2, 31, "Input"],
Cell[37055, 928, 2752, 70, 50, "Output"]
}, Open  ]],
Cell[39822, 1001, 134, 2, 31, "Input"],
Cell[39959, 1005, 131, 2, 31, "Input"],
Cell[CellGroupData[{
Cell[40115, 1011, 167, 4, 31, "Input"],
Cell[40285, 1017, 92, 2, 45, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40414, 1024, 128, 2, 31, "Input"],
Cell[40545, 1028, 69, 1, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40651, 1034, 131, 2, 31, "Input"],
Cell[40785, 1038, 67, 1, 30, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
